# Chap6. 메모리와 캐시 메모리

## 6-1. RAM의 특징과 종류

### RAM의 특징

- RAM에는 실행할 프로그램의 명령어와 데이터가 저장됨
- 전원을 끄면 저장된 내용이 사라짐 - **휘발성 저장 장치**
    - RAM ⇒ 실행할 대상을 저장
- 전원이 꺼져도 저장된 내용이 유지되는 저장 장치 - **비휘발성 저장 장치**
    - 하드 디스크, SSD, CD-ROM, USB 메모리와 같은 보조기억장치 등 → 그러나 CPU는 직접 접근하지 못함 ⇒ 보관할 대상을 저장

### RAM의 용량과 성능

- RAM 용량 ⬇️ → 보조기억장치에서 실행할 프로그램을 가져오는 일이 잦아짐 → 실행 시간이 길어짐
- ex. 보조기억장치는 책장, RAM은 책상
- RAM 용량이 크면 많은 프로그램들을 동시에 빠르게 실행하는데 유리
필요 이상으로 커지면 속도가 그에 비례하는 것은 아님

### RAM의 종류

- **DRAM**
    - Dynamic RAM, 저장된 데이터가 동적으로 변하는(사라지는) RAM, 시간이 지나면 저장된 데이터가 점차 사라짐
    - ➖ 데이터의 소멸을 막기 위해 일정 주기로 데이터 재활성화 필요
    - ➕ 소비 전력이 낮음, 저렴함, 집적도가 높으므로 대용량 설계 용이
- **SRAM**
    - Static RAM, 저장된 데이터가 변하지 않는 RAM (비휘발성인 것은 아님. 전원 공급이 없으면 저장된 내용이 날아감)
    - ➕ DRAM보다 일반적으로 속도가 더 빠름, 재활성화 필요 없음
    - ➖ 소비 전력이 큼, 비쌈, 집적도가 낮음
    - → 대용량일 필요 없고 속도가 빨라야 하는 저장 장치(ex. 캐시 메모리)에서 사용됨
- **SDRAM**
    - Synchronous Dynamic RAM, 클럭 신호에 맞춰 동작하여 클럭마다 CPU와 정보를 주고받을 수 있는, 발전된 형태의 DRAM
- **DDR SDRAM**
    - Double Data Rate SDRAM, 대역폭을 넓혀 속도를 빠르게 만든 SDRAM
        - 대역폭: 데이터를 주고받는 길의 너비 (ex. 자동차 도로)
    - 한 클럭당 두 번씩 CPU와 데이터를 주고받을 수 있음 → 전송 속도가 두 배 빠름
    - DDR2 SDRAM은 4배, DDR3 SDRAM은 8배, DDR4 SDRAM은 16배…
    

## 6-2. 메모리의 주소 공간

### 물리 주소와 논리 주소

- **물리 주소** - 메모리 하드웨어가 사용하는 주소
- **논리 주소** - CPU와 실행 중인 프로그램이 사용하는, 각각의 프로그램에 부여된 논리 주소

![Screenshot 2023-07-13 at 11.46.10 PM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d11ba0bb-da8d-4921-991d-7f9bb2f5f2cf/Screenshot_2023-07-13_at_11.46.10_PM.png)

- CPU와 메모리가 상호작용하려면 논리 주소와 물리 주소 간의 변환이 이루어져야 함
    - 메모리 관리 장치(MMU)라는 하드웨어에 의해 수행됨
        
        ![Screenshot 2023-07-13 at 11.49.26 PM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e1d539f1-2b16-443d-963f-6dbebea3c95a/Screenshot_2023-07-13_at_11.49.26_PM.png)
        
    - 베이스 레지스터는 프로그램의 첫 물리주소를 저장하는 셈
    논리 주소는 프로그램의 시작점으로부터 떨어진 거리인 셈

### 메모리 보호 기법

- 다른 프로그램의 영역을 침범할 수 있는 명령어는 위험할 수 있음
- 논리 주소 범위를 벗어나는 명령어 실행을 방지하고, 실행 중인 프로그램이 다른 프로그램에 영향을 받지 않도록 하는 방법 필요
- **한계 레지스터**
    - 논리 주소의 최대 크기를 저장
    - 만약 CPU가 그보다 높은 논리 주소에 접근하려고 하면 인터럽트(트랩)를 발생

## 6-3. 캐시 메모리

- **캐시 메모리**: CPU가 메모리에 접근하는 시간이 CPU의 연산 속도보다 느림을 극복하기 위한 저장 장치

### 저장 장치 계층 구조

![Screenshot 2023-07-14 at 12.06.37 AM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7a7375f-3ef2-4c2d-b015-728493f17d76/Screenshot_2023-07-14_at_12.06.37_AM.png)

- CPU에 얼마나 가까운가를 기준으로 계층을 나눔

### 캐시 메모리

- CPU가 메모리에 접근하는 속도 << 레지스터에 접근하는 속도, 그래도 메모리에 빈번하게 접근해야 함을 보완하기 위해 캐시 메모리 등장
- CPU와 메모리 사이에 위치한 레지스터보다 용량이 크고 메모리보다 빠른 SRAM 기반의 저장 장치
    - ex. 집 - 편의점 - 대형 마트
- 캐시 메모리 계층 - CPU와 가까운 순서대로
    - L1, L2, L3
        
        ![Screenshot 2023-07-14 at 12.10.56 AM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/985d28ef-e5bc-4782-8563-f8b92af80c74/Screenshot_2023-07-14_at_12.10.56_AM.png)
        
    - 멀티 코어 프로세서에서는 - L1, L2는 코어마다 고유한 캐시 메모리로, L3 캐시는 여러 코어가 공유하는 형태로
        
        ![Screenshot 2023-07-14 at 12.12.22 AM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/48c063ea-e999-4523-937f-d25e30d1fb44/Screenshot_2023-07-14_at_12.12.22_AM.png)
        
    - 분리형 캐시
- 캐시 메모리를 반영한 저장 장치 계층 구조
    
    ![Screenshot 2023-07-14 at 12.13.16 AM.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3bae36fe-2cfc-49a0-9e4e-93f38d013ee8/Screenshot_2023-07-14_at_12.13.16_AM.png)
    

### 참조 지역성 원리

- 캐시 메모리는 CPU가 사용할 법한 대상을 예측하여 저장함
    - **캐시 히트**: 예측한 데이터가 실제로 들어맞아 캐시 메모리 내 데이터가 CPU에서 활용되는 경우
    - **캐시 미스**: 예측이 틀려 메모리에서 필요한 데이터를 직접 가져와야 하는 경우
    - 캐시 적중률
        
        ```
        캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)
        ```
        
- **참조 지역성의 원리**
    1. CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다. ⇒ **시간 지역성**
        - ex. 변수에 값을 저장하고 나면 언제든 다시 접근해 그 값을 사용
    2. CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다. ⇒ **공간 지역성**
        - 프로그램은 보통 관련 데이터들끼리 한데 모여있음
